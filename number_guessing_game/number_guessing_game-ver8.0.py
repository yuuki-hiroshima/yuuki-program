# 作成開始日：2025年9月1日
# 作成完了日：2025年9月2日
# 著作者名：yuuki-hiroshima
# All rights reserved.

# ChatGPT 「数当てゲーム作成方法」を参照
# 回答を間違えた際に残りの間違えられる回数を表示できるようにアップデート

# randomモジュール（ライブラリ）をインポート
import random

# リプレイ機能用のループ（ゲーム全体を繰り返す）
while True:

# --- 難易度選択 ---

    while True: # 正しい選択がされるまで繰り返す
        print("難易度を選んでください：") # 難易度選択の案内
        print("1: かんたん（1〜50）") # 難易度1の説明
        print("2: ふつう（1〜100）") # 難易度2の説明
        print("3: むずかしい（1〜500）") # 難易度3の説明
        mode = input("番号を入力してください（1/2/3）：") # ユーザーに入力を促す

        if mode == "1": # かんたんモード
            low, high = 1, 50 # 範囲を指定
            break # 選択が正しいので難易度選択のwhileループを抜ける
        elif mode == "2": # ふつうモード
            low, high = 1, 100 # 範囲を指定
            break # 選択が正しいので難易度選択のwhileループを抜ける
        elif mode == "3": # むずかしいモード
            low, high = 1, 500 # 範囲を指定
            break # 選択が正しいので難易度選択のwhileループを抜ける
        else:
            print("正しく入力してください（1/2/3）") # エラーメッセージを表示して再入力

    # 選んだ難易度に応じた数字をゲームに当てはめる
    answer = random.randint(low, high) # randint関数はランダムな小数・整数を生成する。randint関数はrandomモジュールのなかに含まれるため、randomモジュールのインポートが必要

    # 上記は冒頭で「from random import randint」としている場合、answer = randint(low, high)と記述しても動作する。

    print("数当てゲームを始めます！") # ゲーム開始のメッセージ
    print(f"{low}〜{high}の数字を当ててください。") # 選んだ難易度に応じたルール説明
    print("挑戦できるのは最大10回です。") # 回数制限のルールを伝える

    # 挑戦回数を超える変数（最初は0回）
    count = 0

    # 挑戦できる最大回数
    limit = 10

# --- 数当てゲーム本体 ---

    # 正解するまで入力を繰り返す
    while count < limit: # 回数が制限以内の間だけ繰り返す
        guess_input = input("あなたの予想は？：") # ユーザーに入力してもらう

        # 入力が整数かチェックする
        try:
            guess = int(guess_input) # 入力を整数に変換（小数や文字列が入力されるなど、エラーが出る可能性のあるコード）
        except ValueError: # 変換できない場合（文字列や小数など）
            print("正しい整数を入力してください。") # エラーメッセージ
            continue # ループの専用に戻り、再入力させる（下の処理に進んでいないためカウントは増えない）
        
        # 数値の範囲をチェック
        if guess < low or guess > high: # 選択した難易度の数値外か判定
            print(f"{low}〜{high}の範囲で入力してください。") # エラーメッセージ
            continue # ループの専用に戻り、再入力させる（下の処理に進んでいないためカウントは増えない）

        # 入力がおこなわれるごと（ループするごと）にカウントを1増やす
        count += 1

        # 残り回数を計算する
        remaining = limit - count

        # 答えと比較
        if guess == answer:
            print("おめでとう！正解です！")
            print(f"{count}回目で当たりました！") # f文字列で回数を表示
            break # 正解したらループを終了
        elif guess > answer: # 入力された数値より小さい場合
            print("もっと小さい数字です。")
        else: # 入力された数値より小さい場合以外（入力された数字より大きい場合）
            print("もっと大きい数字です")

        # 残り回数を表示する（エラーのあとに記述しているためエラー時には表示されず、回数制限の前に記述しているため、回数制限時にも表示されない）
        print(f"間違えられる回数は残り{remaining}回です。")

        # もし回数制限に達したらゲームオーバー
        if count == limit:
            print("残念！ゲームオーバーです。") # ゲームオーバーの表示
            print(f"正解は{answer}でした。") # 正解を表示
            break # 制限回数を超えたのでループを終了

# --- 再プレイの確認 ---

    # もう一度遊ぶかどうかを確認するためのwhileループ（breakの場合は、プログラム全体の先頭のwhileループに戻る）
    while True:
        retry = input("もう一度遊びますか？（y/n）：") # ユーザーに再挑戦するか質問
        retry = retry.lower() # 大文字・小文字を区別しないよう小文字に変換

        if retry == "y": # "y"が入力されたら再挑戦
            break # 内側の while Trueを抜けてゲームをリスタート
        elif retry == "n": # "n"が入力されたら終了
            print("ゲームを終了します。遊んでくれてありがとう！") # 終了のメッセージ
            exit() #プログラムを終了
        else: # yでもnでもない場合
            print("正しく入力してください。（y または n）") # エラーメッセージを表示して再入力を促す